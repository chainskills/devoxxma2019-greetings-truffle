{"version":3,"sources":["drizzleOptions.js","components/Account.js","components/Information.js","components/Greetings.js","components/ServiceFee.js","components/Events.js","App.js","index.js"],"names":["drizzleOptions","web3","block","fallback","type","url","contracts","events","ChainBizz","Account","drizzle","enable","owner","account","balance","useEffect","M","AutoInit","className","diameter","seed","jsNumberForAddress","parseFloat","toFixed","href","style","margin","onClick","Greetings","methods","disableContract","send","from","gas","on","err","console","error","enableContract","Information","greetings","earnings","serviceFee","utils","fromWei","toBN","transferEarning","refFirstField","useRef","useState","setGreetings","current","focus","ref","name","value","data-length","onChange","e","target","height","htmlFor","ServiceFee","newFee","setNewFee","min","step","setServiceFee","toWei","receipt","log","Events","eventGreetings","setEventGreetings","eventServiceFee","setEventServiceFee","Map","eventMap","setEventMap","allEvents","Array","values","reverse","forEach","evt","currentEvent","key","message","push","unsubscribe","event","GreetingsChangedEvent","fromBlock","toBlock","get","id","eventMessage","returnValues","_account","_greetings","set","NewServiceFeeEvent","_serviceFee","subscribe","App","drizzleContext","drizzleState","initialized","setAccount","setBalance","setOwner","setEarnings","setEnable","greetingsKey","setGreetingsKey","serviceFeeKey","setServiceFeeKey","a","currAccout","accounts","eth","getBalance","currBalance","CharacterCounter","init","document","querySelectorAll","getGreetings","cacheCall","getServiceFee","call","address","fetchAccount","window","ethereum","location","reload","currentGreetings","serviceFeeRef","drizzleStore","generateStore","Drizzle","ReactDOM","render","Provider","Consumer","getElementById"],"mappings":"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","file":"static/js/main.39b2d566.chunk.js","sourcesContent":["import Greetings from \"./contracts/Greetings.json\";\n\nconst drizzleOptions = {\n  web3: {\n    block: false,\n    fallback: {\n      type: \"ws\",\n      url: \"ws://127.0.0.1:8545\"\n    }\n  },\n  contracts: [Greetings],\n  events: {\n    ChainBizz: [\"GreetingsChangedEvent\", \"NewServiceFeeEvent\"]\n  }\n};\n\nexport default drizzleOptions;\n","import React, {useEffect} from \"react\";\nimport JazzIcon, {jsNumberForAddress} from \"react-jazzicon\";\n\nimport \"materialize-css/dist/css/materialize.min.css\";\nimport M from \"materialize-css/dist/js/materialize.min.js\";\n\nimport \"./Account.css\";\n\nconst Account = ({drizzle, enable, owner, account, balance}) => {\n  useEffect(() => {\n    M.AutoInit();\n\n    // eslint-disable-next-line\n  }, []);\n\n  const disableContract = () => {\n    const {Greetings} = drizzle.contracts;\n\n    // save the project\n    Greetings.methods\n      .disableContract()\n      .send({\n        from: account,\n        gas: 500000\n      })\n      .on(\"error\", err => {\n        console.error(err);\n      });\n  };\n\n  const enableContract = () => {\n    const {Greetings} = drizzle.contracts;\n\n    // save the project\n    Greetings.methods\n      .enableContract()\n      .send({\n        from: account,\n        gas: 500000\n      })\n      .on(\"error\", err => {\n        console.error(err);\n      });\n  };\n\n  return (\n    <div className=\"col m4\">\n      <div className=\"avatar\">\n        <JazzIcon diameter={40} seed={jsNumberForAddress(account)} />\n        <p className=\"account truncate\">{account}</p>\n        <p className=\"balance\">{parseFloat(balance).toFixed(4)} ETH</p>\n        {owner && enable && (\n          <a\n            href=\"#!\"\n            className=\"waves-effect waves-light btn left primary-content blue\"\n            style={{margin: \"5px\"}}\n            onClick={() => disableContract()}\n          >\n            Disable\n          </a>\n        )}\n\n        {owner && !enable && (\n          <a\n            href=\"#!\"\n            className=\"waves-effect waves-light btn left primary-content blue\"\n            style={{margin: \"5px\"}}\n            onClick={() => enableContract()}\n          >\n            Enable\n          </a>\n        )}\n      </div>\n    </div>\n  );\n};\n\nexport default Account;\n","import React, {useEffect, useState} from \"react\";\n\nimport \"materialize-css/dist/css/materialize.min.css\";\nimport M from \"materialize-css/dist/js/materialize.min.js\";\n\nimport \"./Account.css\";\n\nconst Information = ({\n  drizzle,\n  greetings,\n  account,\n  earnings,\n  serviceFee,\n  owner\n}) => {\n  useEffect(() => {\n    M.AutoInit();\n\n    // eslint-disable-next-line\n  }, []);\n\n  const onTransferEarning = () => {\n    const {Greetings} = drizzle.contracts;\n\n    // save the project\n    Greetings.methods\n      .transferEarning()\n      .send({\n        from: account,\n        gas: 500000\n      })\n      .on(\"error\", err => {\n        console.error(err);\n      });\n  };\n\n  return (\n    <div className=\"row\">\n      <div className=\"col m12\">\n        <p>The current greetings is: {greetings}</p>\n      </div>\n      <div className=\"col m12\">\n        <p>\n          The service fee is:{\" \"}\n          {serviceFee !== null\n            ? drizzle.web3.utils.fromWei(serviceFee, \"ether\")\n            : null}{\" \"}\n          ETH\n        </p>\n      </div>\n      {owner && (\n        <div>\n          <div className=\"col m8\">\n            <p>\n              Your earning is:{\" \"}\n              {drizzle.web3.utils.fromWei(\n                drizzle.web3.utils.toBN(earnings),\n                \"ether\"\n              )}{\" \"}\n              ETH\n            </p>\n          </div>\n          {earnings > 0 && (\n            <div className=\"col m3\">\n              <a\n                href=\"#!\"\n                className=\"waves-effect waves-light btn left primary-content blue\"\n                style={{margin: \"5px\"}}\n                onClick={() => onTransferEarning()}\n              >\n                Transfer\n              </a>\n            </div>\n          )}\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default Information;\n","import React, {useState, useEffect, useRef} from \"react\";\n\nimport \"materialize-css/dist/css/materialize.min.css\";\nimport M from \"materialize-css/dist/js/materialize.min.js\";\n\nconst Greetings = ({drizzle, account, serviceFee}) => {\n  const refFirstField = useRef(null);\n\n  const [greetings, setGreetings] = useState(\"\");\n\n  useEffect(() => {\n    M.AutoInit();\n\n    // give focus to the first field\n    if (refFirstField !== null) {\n      refFirstField.current.focus();\n    }\n\n    // eslint-disable-next-line\n  }, []);\n\n  const onChange = e => {\n    setGreetings(e.target.value);\n  };\n\n  const onSaveGreetings = () => {\n    const {Greetings} = drizzle.contracts;\n\n    // save the project\n    Greetings.methods\n      .setGreetings(greetings)\n      .send({\n        from: account,\n        gas: 500000,\n        value: serviceFee\n      })\n      .on(\"error\", err => {\n        console.error(err);\n      });\n  };\n\n  return (\n    <div className=\"row\">\n      <div className=\"col m9 input-field\">\n        <textarea\n          className=\"materialize-textarea has-character-counter\"\n          ref={refFirstField}\n          type=\"text\"\n          name=\"message\"\n          value={greetings}\n          data-length={50}\n          onChange={onChange}\n          style={{height: \"4rem\"}}\n        />\n\n        <label htmlFor=\"title\" className=\"active\">\n          Enter a new Greetings\n        </label>\n      </div>\n      <div className=\"col m3 input-field\">\n        <a\n          href=\"#!\"\n          className=\"waves-effect waves-light btn left primary-content blue\"\n          onClick={() => onSaveGreetings()}\n          style={{margin: \"5px\"}}\n        >\n          Send\n        </a>\n      </div>\n    </div>\n  );\n};\n\nexport default Greetings;\n","import React, {useState} from \"react\";\n\nimport \"materialize-css/dist/css/materialize.min.css\";\n\nconst ServiceFee = ({drizzle, account, serviceFee}) => {\n  const [newFee, setNewFee] = useState(\n    drizzle.web3.utils.fromWei(\n      drizzle.web3.utils.toBN(serviceFee !== null ? serviceFee : 0, \"ether\")\n    )\n  );\n\n  const onChange = e => {\n    setNewFee(e.target.value);\n  };\n\n  const onSaveServiceFee = () => {\n    const {Greetings} = drizzle.contracts;\n\n    // save the project\n    Greetings.methods\n      .setServiceFee(drizzle.web3.utils.toWei(newFee))\n      .send({\n        from: account,\n        gas: 500000\n      })\n      .on(\"receipt\", receipt => {\n        console.log(receipt);\n      })\n      .on(\"error\", err => {\n        console.error(err);\n      });\n  };\n\n  return (\n    <div className=\"row\">\n      <div className=\"col m9 input-field\">\n        <input\n          type=\"number\"\n          name=\"serviceFee\"\n          value={newFee}\n          min={0}\n          onChange={onChange}\n          step={\".01\"}\n        />\n        <label htmlFor=\"price\" className=\"active\">\n          Service fee in ETH\n        </label>\n      </div>\n      <div className=\"col m3 input-field\">\n        <a\n          href=\"#!\"\n          className=\"waves-effect waves-light btn left primary-content blue\"\n          onClick={() => onSaveServiceFee()}\n          style={{margin: \"5px\"}}\n        >\n          Send\n        </a>\n      </div>\n    </div>\n  );\n};\n\nexport default ServiceFee;\n","import React, {useState} from \"react\";\n\nimport \"materialize-css/dist/css/materialize.min.css\";\n\nconst Events = ({drizzle, owner}) => {\n  const {Greetings} = drizzle.contracts;\n  const [eventGreetings, setEventGreetings] = useState(null);\n  const [eventServiceFee, setEventServiceFee] = useState(null);\n  const [eventMap, setEventMap] = useState(new Map());\n\n  const subscribe = () => {\n    if (eventGreetings === null) {\n      const event = Greetings.events\n        .GreetingsChangedEvent({\n          fromBlock: \"latest\",\n          toBlock: \"latest\"\n        })\n        .on(\"data\", function(eventGreetings) {\n          if (typeof eventMap.get(eventGreetings.id) === \"undefined\") {\n            const eventMessage =\n              \"Account: \" +\n              eventGreetings.returnValues._account +\n              \" Greetings: \" +\n              eventGreetings.returnValues._greetings;\n\n            eventMap.set(eventGreetings.id, {\n              key: eventGreetings.id,\n              name: eventGreetings.event,\n              message: eventMessage\n            });\n            setEventMap(eventMap);\n          }\n        })\n        .on(\"error\", function(error) {\n          console.error(error);\n        });\n\n      setEventGreetings(event);\n    }\n\n    if (owner && eventServiceFee === null) {\n      const event = Greetings.events\n        .NewServiceFeeEvent({\n          fromBlock: \"latest\",\n          toBlock: \"latest\"\n        })\n        .on(\"data\", function(eventServiceFee) {\n          if (typeof eventMap.get(eventServiceFee.id) === \"undefined\") {\n            const eventMessage =\n              \"New Service fee: \" +\n              drizzle.web3.utils.fromWei(\n                eventServiceFee.returnValues._serviceFee,\n                \"ether\"\n              );\n\n            eventMap.set(eventServiceFee.id, {\n              key: eventServiceFee.id,\n              name: eventServiceFee.event,\n              message: eventMessage\n            });\n\n            setEventMap(eventMap);\n          }\n        })\n        .on(\"error\", function(error) {\n          console.error(error);\n        });\n\n      setEventServiceFee(event);\n    }\n  };\n\n  const unsubscribe = () => {\n    if (eventGreetings !== null) {\n      eventGreetings.unsubscribe();\n      setEventGreetings(null);\n    }\n    if (eventServiceFee !== null) {\n      eventServiceFee.unsubscribe();\n      setEventServiceFee(null);\n    }\n\n    setEventMap(new Map());\n  };\n\n  let allEvents = [];\n  if (eventMap !== null && typeof eventMap !== \"undefined\") {\n    // received a new event\n    const eventsList = Array.from(eventMap.values());\n    eventsList.reverse().forEach(evt => {\n      const currentEvent = (\n        <p key={evt.key}>\n          [<span className=\"notifications-item\">{evt.name}</span>] ->{\" \"}\n          <span>{evt.message}</span>\n        </p>\n      );\n\n      allEvents.push(currentEvent);\n    });\n  }\n\n  return (\n    <div>\n      <div className=\"row\">\n        <div className=\"col m3 push-m8 input-field\">\n          {eventGreetings !== null && (\n            <a\n              href=\"#!\"\n              className=\"waves-effect waves-light btn left primary-content blue\"\n              style={{margin: \"5px\"}}\n              onClick={() => unsubscribe()}\n            >\n              Unsubscribe\n            </a>\n          )}\n          {eventGreetings === null && (\n            <a\n              href=\"#!\"\n              className=\"waves-effect waves-light btn left primary-content blue\"\n              style={{margin: \"5px\"}}\n              onClick={() => subscribe()}\n            >\n              Subscribe\n            </a>\n          )}\n        </div>\n      </div>\n      <div className=\"row\">\n        <div className=\"col m12\">{allEvents}</div>\n      </div>\n    </div>\n  );\n};\n\nexport default Events;\n","import React, {useState, useEffect} from \"react\";\n\nimport \"materialize-css/dist/css/materialize.min.css\";\nimport M from \"materialize-css/dist/js/materialize.min.js\";\n\nimport Account from \"./components/Account\";\nimport Information from \"./components/Information\";\nimport Greetings from \"./components/Greetings\";\nimport ServiceFee from \"./components/ServiceFee\";\nimport Events from \"./components/Events\";\n\nimport \"./App.css\";\n\nconst App = ({drizzleContext}) => {\n  const {drizzleState, drizzle, initialized} = drizzleContext;\n  const [account, setAccount] = useState(null);\n  const [balance, setBalance] = useState(0);\n  const [owner, setOwner] = useState(null);\n  const [earnings, setEarnings] = useState(0);\n  const [enable, setEnable] = useState(false);\n\n  const [greetingsKey, setGreetingsKey] = useState(null);\n  const [serviceFeeKey, setServiceFeeKey] = useState(null);\n\n  useEffect(() => {\n    M.AutoInit();\n\n    // eslint-disable-next-line\n  }, []);\n\n  useEffect(() => {\n    if (initialized) {\n      async function fetchAccount() {\n        const currAccout = drizzleState.accounts[0];\n        const currBalance = await drizzle.web3.eth.getBalance(currAccout);\n\n        setAccount(currAccout);\n        setBalance(drizzle.web3.utils.fromWei(currBalance, \"ether\"));\n\n        M.CharacterCounter.init(\n          document.querySelectorAll(\".has-character-counter\")\n        );\n\n        const {Greetings} = drizzle.contracts;\n        setGreetingsKey(Greetings.methods.getGreetings.cacheCall());\n        setServiceFeeKey(\n          Greetings.methods.getServiceFee.cacheCall({from: currAccout})\n        );\n\n        setOwner(await Greetings.methods.owner().call());\n\n        setEarnings(await drizzle.web3.eth.getBalance(Greetings.address));\n\n        setEnable(await Greetings.methods.enable().call());\n      }\n      fetchAccount();\n    }\n    // eslint-disable-next-line\n  }, [initialized, drizzleState]);\n\n  if (!initialized || account === null) {\n    return (\n      <div className=\"container\">\n        <h2>Preparing the Dapp ...</h2>\n      </div>\n    );\n  }\n\n  // detect account changes from Metamask\n  window.ethereum.on(\"accountsChanged\", function(accounts) {\n    // reload the page to refresh all context\n    window.location.reload();\n  });\n\n  // prepare ...\n  let currentGreetings = null;\n  if (greetingsKey !== null) {\n    if (\n      drizzleState.contracts.Greetings.getGreetings[greetingsKey] &&\n      drizzleState.contracts.Greetings.getGreetings[greetingsKey].value\n    ) {\n      currentGreetings =\n        drizzleState.contracts.Greetings.getGreetings[greetingsKey].value;\n    }\n  }\n\n  let serviceFeeRef = null;\n  if (serviceFeeKey !== null) {\n    if (\n      drizzleState.contracts.Greetings.getServiceFee[serviceFeeKey] &&\n      drizzleState.contracts.Greetings.getServiceFee[serviceFeeKey].value\n    ) {\n      serviceFeeRef =\n        drizzleState.contracts.Greetings.getServiceFee[serviceFeeKey].value;\n    }\n  }\n\n  return (\n    <div className=\"container\">\n      <div className=\"row\">\n        <Account\n          drizzle={drizzle}\n          enable={enable}\n          account={account}\n          owner={owner === account ? true : false}\n          balance={balance}\n        />\n\n        <div className=\"col m8 greetings-data\">\n          <Information\n            drizzle={drizzle}\n            greetings={currentGreetings}\n            serviceFee={serviceFeeRef}\n            account={account}\n            earnings={earnings}\n            owner={owner === account ? true : false}\n          />\n          <Greetings\n            drizzle={drizzle}\n            account={account}\n            serviceFee={serviceFeeRef}\n          />\n\n          {owner === account && (\n            <ServiceFee\n              drizzle={drizzle}\n              account={account}\n              serviceFee={serviceFeeRef}\n            />\n          )}\n        </div>\n      </div>\n      <div className=\"row\">\n        <div className=\"col m8 push-m4 greetings-data\">\n          <Events drizzle={drizzle} owner={owner === account ? true : false} />\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default App;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\n\nimport {DrizzleContext} from \"@drizzle/react-plugin\";\nimport {Drizzle, generateStore} from \"@drizzle/store\";\n\nimport drizzleOptions from \"./drizzleOptions\";\n\nimport App from \"./App\";\n\n// configure drizzle\nconst drizzleStore = generateStore(drizzleOptions);\nconst drizzle = new Drizzle(drizzleOptions, drizzleStore);\n\nReactDOM.render(\n  <DrizzleContext.Provider drizzle={drizzle}>\n    <DrizzleContext.Consumer>\n      {drizzleContext => {\n        return <App drizzleContext={drizzleContext} />;\n      }}\n    </DrizzleContext.Consumer>\n  </DrizzleContext.Provider>,\n  document.getElementById(\"root\")\n);\n"],"sourceRoot":""}